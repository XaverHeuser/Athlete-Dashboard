version: 2

models:
  - name: staging_activities
    description: "{{ doc('staging_activities__doc') }}"
    columns:
      # Core identifiers
      - name: activity_id
        description: "Unique identifier for each activity."
        tests:
          - not_null
          - unique

      - name: athlete_id
        description: "Unique identifier of the athlete who performed the activity."
        tests:
          - not_null

      - name: map_id
        description: "Identifier for the Strava map object linked to this activity."

      # Basic info
      - name: name
        description: "Activity name as entered in Strava (e.g., 'Morning Ride')."
        tests:
          - not_null

      - name: type
        description: "Deprecated Strava activity type field (legacy)."

      - name: sport_type
        description: "Current Strava activity sport type (e.g., 'Run', 'Ride', 'Swim')."
        tests:
          - not_null
          # - accepted_values:
          #   arguments:
          #     values: ['Ride', 'Run', 'Swim', 'Hike', 'Walk', 'VirtualRide', 'WeightTraining', 'InlineSkate']

      - name: distance_m
        description: "Distance covered in meters."


      - name: moving_time_s
        description: "Time spent moving, in seconds."
      - name: elapsed_time_s
        description: "Total elapsed time including pauses, in seconds."
      - name: elevation_gain_m
        description: "Total elevation gain in meters."

      # Timestamps
      - name: start_date_utc
        description: "Start time in UTC."
        tests:
          - not_null

      - name: start_date_local
        description: "Start time in the athlete's local timezone."
      - name: timezone
        description: "Timezone string (e.g. 'Europe/Vienna')."

      # Location
      - name: location_city
        description: "City of activity (if available)."
      - name: location_state
        description: "State or region of activity."
      - name: location_country
        description: "Country where the activity occurred."

      # Performance
      - name: avg_speed_mps
        description: "Average speed in meters per second."
      - name: max_speed_mps
        description: "Maximum speed in meters per second."
      - name: avg_heartrate
        description: "Average heart rate (bpm)."
      - name: max_heartrate
        description: "Maximum heart rate (bpm)."
      - name: avg_cadence
        description: "Average cadence (rpm)."
      - name: avg_temp_c
        description: "Average temperature (Â°C)."
      - name: energy_kj
        description: "Energy output in kilojoules."
      - name: avg_watts
        description: "Average power output in watts."
      - name: max_watts
        description: "Maximum power output in watts."
      - name: weighted_watts
        description: "Weighted average power over the activity."

      # Meta flags
      - name: is_trainer
        description: "TRUE if performed on a trainer (indoor)."
      - name: is_commute
        description: "TRUE if marked as commute."
      - name: is_manual
        description: "TRUE if manually entered activity."
      - name: is_private
        description: "TRUE if private activity."
      - name: is_flagged
        description: "TRUE if flagged on Strava."
      - name: has_heartrate
        description: "TRUE if heart rate data available."
      - name: visibility
        description: "Visibility setting of the activity."

      # Engagement
      - name: achievement_count
        description: "Number of achievements earned."
      - name: kudos_count
        description: "Number of kudos received."
      - name: comment_count
        description: "Number of comments."
      - name: photo_count
        description: "Number of photos uploaded."

      # Map info
      - name: map_polyline
        description: "Encoded map polyline for the route."
      - name: map_resource_state
        description: "Strava map resource state integer."

      # Upload / Metadata
      - name: upload_id
        description: "Upload identifier for this activity."
      - name: upload_id_str
        description: "Upload identifier as string."
      - name: external_id
        description: "External reference (e.g., from device file)."
      - name: resource_state
        description: "Resource state flag from Strava API."
      - name: _staged_at
        description: "Timestamp when data was staged by dbt."
